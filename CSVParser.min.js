!function(a){"use strict";var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p;d="0.1.3",c={delimiter:",",qualifier:'"',strict:!0,trim:!0},b=function(a,b){var d;"string"==typeof a?this.data(a):(this.data(""),b=a),b||(b={});for(d in c)c.hasOwnProperty(d)&&(this["_"+d]=b.hasOwnProperty(d)?b[d]:c[d])},b.prototype={delimiter:function(a){return arguments.length?(this._delimiter=a,this._arrayDirty=this._jsonDirty=!0,this):this._delimiter},qualifier:function(a){if(!arguments.length)return this._qualifier;if(1!==a.length)throw new Error('Qualifiers must be a single character, e.g. "');return this._qualifier=a,this._arrayDirty=this._jsonDirty=!0,this},data:function(a){return arguments.length?(this._data=a,this._arrayDirty=this._jsonDirty=!0,this):this._data},array:function(){var a;return this._arrayDirty&&(a={data:this._data,delimiter:this._delimiter,qualifier:this._qualifier,pos:0,remaining:function(){return this.data.substring(this.pos)},"char":function(a){return this.data.charAt(this.pos+(a||0))},strict:this._strict,trim:this._trim},this._array=j(a,this._strict)||[],this._arrayDirty=!1),this._array},json:function(){var a,b;return this._jsonDirty&&(a=this.array().slice(),b=a.shift(),this._json=a.map(function(a){var c,d,e={};for(d=a.length,c=0;d>c;c+=1)a.hasOwnProperty(c)&&""!==a[c]&&(e[b[c]]=a[c]);return e}),this._jsonDirty=!1),this._json}},e="\n",f="\r\n",g=function(a){return a.char()===a.delimiter?(a.pos+=1,a.delimiter):null},h=/^\r?\n/,i=function(a){var b=a.remaining();return b.substr(0,2)===f?(a.pos+=2,f):b.charAt(0)===e?(a.pos+=1,e):null},j=function(a){var b,c,d;if(!a.data)return[];if(c=k(a),!c)return null;for(b=[c],d=c.length;i(a)&&(c=k(a));){if(a.strict){for(;c.length<d;)c[c.length]="";if(c.length!==d)throw new Error("Malformed data - all rows must have the same number of cells")}b[b.length]=c}return b},k=function(a){var b,c;if(!a.char()||h.test(a.remaining()))return null;for(b=[l(a)];g(a);)c=l(a),b[b.length]=c;return b},l=function(a){var b,c;if(i(a))return"";c=n(a)||m(a),a.trim&&(c=c.trim());try{b=JSON.parse(c)}catch(d){b=c}return b},n=function(a){var b,c,d,e,f;if(p(a),a.char()!==a.qualifier)return null;for(b="",c=!0,a.pos+=1;c&&(d=a.char());)d===a.qualifier?(a.pos+=1,f=a.remaining(),e=f[0],!e||e===a.delimiter||h.test(f)?c=!1:e===a.qualifier?(b+=e,a.pos+=1):b+=d):(b+=d,a.pos+=1);return b},m=function(a){var b,c,d,g,h,i,j;return p(a),b=a.remaining(),d=b.indexOf(a.delimiter),g=b.indexOf(f),h=b.indexOf(e),i=-1===g?h:-1===h?g:Math.min(g,h),-1===d&&-1===i?(c=b,a.pos+=c.length,c):(j=-1===d?i:-1===i?d:Math.min(d,i),c=b.substr(0,j),a.pos+=c.length,c)},o=/^\s+/,p=function(a){var b,c;b=a.remaining(),c=o.exec(b),c&&(a.pos+=c[0].length)},b.VERSION=d,Array.prototype.map||(Array.prototype.map=function(a,b){var c,d,e=[];for(c=0,d=this.length;d>c;c+=1)this.hasOwnProperty(c)&&(e[c]=a.call(b,this[c],c,this));return e}),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+/,"").replace(/\s+$/,"")}),"undefined"!=typeof module&&module.exports?module.exports=b:"undefined"!=typeof define&&define.amd?define(function(){return b}):a.CSVParser=b}(this);