!function(a){"use strict";var b,c,d,e,f,g,h,i,j,k;c="<%= version %>",b=function(a){this._d=",",this._q='"',this.data(a||"")},b.prototype={delimiter:function(a){return arguments.length?(this._d=a,this._arrayDirty=this._jsonDirty=!0,this):this._d},qualifier:function(a){if(!arguments.length)return this._q;if(1!==a.length)throw new Error('Qualifiers must be a single character, e.g. "');return this._q=a,this._arrayDirty=this._jsonDirty=!0,this},data:function(a){return arguments.length?(this._data=a||"",this._arrayDirty=this._jsonDirty=!0,this):this._data},array:function(){var a;return this._arrayDirty&&(a={data:this._data,delimiter:this._d,qualifier:this._q,pos:0,remaining:function(){return this.data.substring(this.pos)},nextChar:function(){return this.data.charAt(this.pos)}},this._array=e(a)||[],this._arrayDirty=!1),this._array},json:function(){var a,b;return this._jsonDirty&&(a=this.array().slice(),b=a.shift(),this._json=a.map(function(a){var c,d,e={};for(d=a.length,c=0;d>c;c+=1)a.hasOwnProperty(c)&&""!==a[c]&&(e[b[c]]=a[c]);return e}),this._jsonDirty=!1),this._json}},d=function(a,b){return 0===a.remaining().indexOf(b)?(a.pos+=b.length,b):null},e=function(a){var b,c,e;if(c=f(a),!c)return null;for(b=[c],e=c.length;d(a,"\n")&&(c=f(a));){for(;c.length<e;)c[c.length]="";if(c.length!==e)throw new Error("Malformed data - all rows must have the same number of cells");b[b.length]=c}return b},f=function(a){var b,c;if(c=g(a),!c)return null;for(b=[c];d(a,a.delimiter);)c=g(a),b[b.length]=c;return b},g=function(a){var b,c=i(a)||h(a);try{b=JSON.parse(c)}catch(d){b=c}return b},i=function(a){var b,c,d,e;if(k(a),a.nextChar()!==a.qualifier)return null;for(b="",c=!0,a.pos+=1;c&&(d=a.nextChar());)d!==a.qualifier||e?b+=d:c=!1,e?e=!1:"\\"===d&&(e=!0),a.pos+=1;return b},h=function(a){var b,c,d,e,f;return k(a),b=a.remaining(),d=b.indexOf(a.delimiter),e=b.indexOf("\n"),-1===d&&-1===e?(c=b,a.pos+=c.length,c):(f=-1===d?e:-1===e?d:Math.min(d,e),c=b.substr(0,f),a.pos+=c.length,c)},j=/^\s+/,k=function(a){var b,c;b=a.remaining(),c=j.exec(b),c&&(a.pos+=c[0].length)},b.VERSION=c,Array.prototype.map||(Array.prototype.map=function(a,b){var c,d,e=[];for(c=0,d=this.length;d>c;c+=1)this.hasOwnProperty(c)&&(e[c]=a.call(b,this[c],c,this));return e}),"undefined"!=typeof module&&module.exports?module.exports=b:"undefined"!=typeof define&&define.amd?define(function(){return b}):a.CSVParser=b}(this);