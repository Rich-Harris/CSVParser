!function(a){"use strict";var b,c,d,e,f,g,h,i,j,k,l,m;d="0.1.2",c={delimiter:",",qualifier:'"',strict:!0},b=function(a,b){var d;"string"==typeof a?this.data(a):(this.data(""),b=a),b||(b={});for(d in c)c.hasOwnProperty(d)&&(this["_"+d]=b.hasOwnProperty(d)?b[d]:c[d])},b.prototype={delimiter:function(a){return arguments.length?(this._delimiter=a,this._arrayDirty=this._jsonDirty=!0,this):this._delimiter},qualifier:function(a){if(!arguments.length)return this._qualifier;if(1!==a.length)throw new Error('Qualifiers must be a single character, e.g. "');return this._qualifier=a,this._arrayDirty=this._jsonDirty=!0,this},data:function(a){return arguments.length?(this._data=a.replace("\r\n",e),this._arrayDirty=this._jsonDirty=!0,this):this._data},array:function(){var a;return this._arrayDirty&&(a={data:this._data,delimiter:this._delimiter,qualifier:this._qualifier,pos:0,remaining:function(){return this.data.substring(this.pos)},"char":function(a){return this.data.charAt(this.pos+(a||0))}},this._array=g(a,this._strict)||[],this._arrayDirty=!1),this._array},json:function(){var a,b;return this._jsonDirty&&(a=this.array().slice(),b=a.shift(),this._json=a.map(function(a){var c,d,e={};for(d=a.length,c=0;d>c;c+=1)a.hasOwnProperty(c)&&""!==a[c]&&(e[b[c]]=a[c]);return e}),this._jsonDirty=!1),this._json}},e="\n",f=function(a,b){return 0===a.remaining().indexOf(b)?(a.pos+=b.length,b):null},g=function(a,b){var c,d,g;if(d=h(a),!d)return null;for(c=[d],g=d.length;f(a,e)&&(d=h(a));){if(b){for(;d.length<g;)d[d.length]="";if(d.length!==g)throw new Error("Malformed data - all rows must have the same number of cells")}c[c.length]=d}return c},h=function(a){var b,c;if(c=i(a),!c)return null;for(b=[c];f(a,a.delimiter);)c=i(a),b[b.length]=c;return b},i=function(a){var b,c=k(a)||j(a);try{b=JSON.parse(c)}catch(d){b=c}return b},k=function(a){var b,c,d,f,g,h,i;if(m(a),a.char()!==a.qualifier)return null;for(b="",c=!0,a.pos+=1;c&&(d=a.char());)d!==a.qualifier||i||(f=!0,g=a.char(1),h=!g||g===a.delimiter||g===e),f&&h?c=!1:b+=d,i?i=!1:"\\"===d&&(i=!0),a.pos+=1;return b},j=function(a){var b,c,d,f,g;return m(a),b=a.remaining(),d=b.indexOf(a.delimiter),f=b.indexOf(e),-1===d&&-1===f?(c=b,a.pos+=c.length,c):(g=-1===d?f:-1===f?d:Math.min(d,f),c=b.substr(0,g),a.pos+=c.length,c)},l=/^\s+/,m=function(a){var b,c;b=a.remaining(),c=l.exec(b),c&&(a.pos+=c[0].length)},b.VERSION=d,Array.prototype.map||(Array.prototype.map=function(a,b){var c,d,e=[];for(c=0,d=this.length;d>c;c+=1)this.hasOwnProperty(c)&&(e[c]=a.call(b,this[c],c,this));return e}),"undefined"!=typeof module&&module.exports?module.exports=b:"undefined"!=typeof define&&define.amd?define(function(){return b}):a.CSVParser=b}(this);